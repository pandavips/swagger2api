# swagger2apis 2.0
è¿™æ˜¯ä¸€ä¸ªå¯ä»¥æŠŠåç«¯çš„swaggeræ–‡æ¡£å¿«é€Ÿè½¬æ¢æˆapiå®šä¹‰æ–‡ä»¶çš„æ’ä»¶ï¼Œå‡å°‘ä½çº§çš„é‡å¤åŠ³åŠ¨æ‘§æ®‹æˆ‘ä»¬çš„èº«å¿ƒï¼Œè®©ä½ çš„ç²¾åŠ›ä¸“æ³¨äºä½ çœŸæ­£åº”è¯¥å…³æ³¨çš„éƒ¨åˆ†ã€‚å³ä½¿ä½ åœ¨çœ‹åˆ°è¿™ä¸ªå·¥å…·æ—¶,ä½ çš„é¡¹ç›®å·²ç»è¿ä½œäº†å¥½ä¸€æ®µæ—¶é—´,ä½ ä¾ç„¶å¯ä»¥ç«‹å³åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨å®ƒ,å®ƒä¸ä¼šäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨,å®ƒåªä¼šåœ¨å¾€åçš„æ—¥å­é‡Œå‡è½»ä½ çš„å·¥ä½œå‹åŠ›ã€‚

ä½ éœ€è¦çš„æ˜¯æ¥å—å®ƒ,å¹¶ä½¿ç”¨å®ƒã€‚ğŸ˜

ç‰¹æ€§ï¼š
- è‡ªåŠ¨ç”Ÿæˆ`ts`ï¼Œ`tsç±»å‹å®šä¹‰`æ–‡ä»¶ï¼Œå¯é€šè¿‡å†…ç½®æ’ä»¶ç¼–è¯‘ä¸ºjs

- æ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿,åæœŸä¼šå®ç°åœ¨çº¿å³æ—¶é¢„è§ˆç¼–è¯‘ç»“æœ

- æ”¯æŒä¸€ä¸ªæ’ä»¶ç³»ç»Ÿï¼Œè®©ä½ æ›´å®¹æ˜“å®ç°è‡ªå·±çš„ç‰¹å®šéœ€æ±‚ï¼›å†…éƒ¨å·²ç»å®ç°ä¸€äº›å¸¸è§çš„æ’ä»¶ï¼ŒåŸºæœ¬è®©ä½ åšåˆ°å¼€ç®±å³ç”¨

## TDOO

- [x] é‡æ„1.0æ‰€æœ‰åŠŸèƒ½(å·²å®Œæˆ)
- [x] å®ç°æ’ä»¶ç³»ç»Ÿ
- [x] å…¼å®¹1.0ç”Ÿæˆçš„å†…å®¹,é¢„è®¡è¿™éƒ¨åˆ†å†…å®¹ä¼šé€šè¿‡æ’ä»¶æ¥å…¼å®¹
- [x] å®Œå–„å¢å¼ºå°åŠŸèƒ½
- [x] å®Œå–„æ›´å¤šçš„è¾¹ç¼˜case
- [ ] å®ç°æ¨¡æ¿ç¼–è¾‘å³æ—¶é¢„è§ˆé¡µé¢
- [ ] æˆ–è®¸åº”è¯¥ä¸ºæ’ä»¶å®šä¹‰ä¸€äº›å…ƒæ•°æ®å†…å®¹,æ¯”å¦‚ä¼˜å…ˆçº§ç­‰


## ï¼’.ï¼ä½¿ç”¨è¯´æ˜
1.xæ¥è®²æ˜¯ä¸€ä¸ªæ¯«æ— è®¾è®¡çš„ç‰ˆæœ¬ï¼Œåªæ˜¯æºäºè‡ªå·±çš„ä¸€ä¸ªæƒ³æ³•,è™½ç„¶ä¸œæ‹¼è¥¿å‡‘ï¼Œä½†æ˜¯å®ƒä¾ç„¶å®ç°äº†è‡ªå·±çš„ä¸€éƒ¨åˆ†ä»·å€¼ï¼ˆç¬‘ï¼‰ï¼›ç›¸è¾ƒäº1.xæ¥è¯´ï¼Œ2.xæ¥è®²æˆ‘ä»¬åšå‡ºäº†ä¸€äº›å˜åŒ–ï¼Œè®©å®ƒçœ‹èµ·æ¥ç¨å¾®åƒäº†é‚£ä¹ˆå›äº‹~ã€‚åœ¨2.xä¸­æˆ‘ä»¬å°†æ•°æ®æºçš„è·å–è¡Œä¸ºäº¤ç»™äº†ä½ è‡ªå·±ï¼Œæ­¤å·¥å…·åªå…³å¿ƒæ•°æ®çš„å¤„ç†ï¼Œè¿™æ ·ä½ å¯ä»¥æ›´æ–¹ä¾¿çš„å°†æ‰“åŒ…å¥½çš„æ•°æ®å‘é€ç»™è¿™ä¸ªæ’ä»¶ï¼›ä½¿ç”¨æ–¹å¼ä¹Ÿå¾—åˆ°äº†æ›´æ–°ï¼Œæ‰€æœ‰é…ç½®é¡¹éƒ½æ›¿æ¢æˆäº†æ’ä»¶çš„æ’æ‹”ï¼Œè¿™æ ·è¯´å¯èƒ½æœ‰ç‚¹è¿·ç³Šï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œä¸‹è¾¹å¾ˆå¿«ä¼šç”¨ç¤ºä¾‹è®©ä½ æ˜ç™½ã€‚

###ã€€å®‰è£…
```shell
# å¼ºçƒˆå»ºè®®ä½¿ç”¨èš‚èšå¤§ä½¬çš„ni,å› ä¸ºå¯ä»¥æ— è§†åŒ…ç®¡ç†å™¨å·®å¼‚
npm i @antfu/ni -g
# ç„¶å
ni swagger2apis -D
```
###ã€€ä½¿ç”¨
åœ¨ä½ é¡¹ç›®ä¸­ä»»ä½•åœ°æ–¹æ–°å»ºä¸€ä¸ªjsè„šæœ¬ï¼Œå†…å®¹å¯ä»¥æ˜¯ä¸‹è¾¹è¿™æ ·çš„ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ²¡æœ‰ä»»ä½•é…ç½®é¡¹ï¼Œä¸‹é¢çš„è„šæœ¬å†…å®¹æˆ‘ä¼šå°½å¯èƒ½çš„æŠŠæ‰€æœ‰å†…ç½®æ’ä»¶éƒ½ç”¨ä¸Š,å€Ÿæ­¤æœºä¼šæ¥è¯´æ˜æ’ä»¶çš„ä½œç”¨.

```js
import fs from 'fs'
import axios from 'axios'
import {
  create,
  readFileAsString,
  getCurrentDirName
  // ---æ’ä»¶---
  // ä¼šåœ¨apiçš„æè¿°ä¸­åŠ å…¥å…¥å‚å‡ºå‚çš„æ ‡æ³¨
  ApiTypeInDescription,
  // 1.xç‰ˆæœ¬çš„æ–¹æ³•åå…¼å®¹æ’ä»¶ï¼Œå¦‚æœä½ çš„é¡¹ç›®æ˜¯æ–°é¡¹ç›®ï¼Œå¼ºçƒˆå»ºè®®ç¦ç”¨è¯¥æ’ä»¶ï¼Œå› ä¸ºæ–°çš„å‘½åæ–¹å¼é¿å…äº†ä¸€äº›é—®é¢˜
  CompatibleApiFnNameOnOldversionHandle,
  // åœ¨æ–‡ä»¶å¤´éƒ¨æ’å…¥è­¦å‘Šä¿¡æ¯
  FileHeaderAppendWarning,
  // æ¨¡å—åŒ–æ–‡ä»¶æ¸²æŸ“å™¨
  createApiFileModularRender,
  // ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–
  createCodeFormatterPlugin,
  // ç¼–è¯‘ts > js
  createCompileTS2JSPlugin,
  // ç§»é™¤apiå…¬å…±å‰ç¼€
  createPrefixRemovePlugin,

} from 'swagger2apis'
import { join } from 'path'

// åˆ é™¤tsæ–‡ä»¶æ’ä»¶
const DeleteTsFilePlugin = {
  afterWriteFile: async (ctx) => {
    const { writedFileList } = ctx
    // è¿‡æ»¤å‡ºtsæ–‡ä»¶
    const tsFileList = writedFileList.filter((item) => item.endsWith('.ts') && !item.endsWith('.d.ts'))
    // ç„¶ååˆ é™¤æ‰
    tsFileList.forEach((file) => {
      fs.unlinkSync(file)
    })
    return ctx
  }
}

;(async () => {
  // ä½¿ç”¨é¡¹ç›®çš„æ ¼å¼åŒ–é£æ ¼æ¥æ ¼å¼ä»£ç 
  const prettierConfig = JSON.parse(
    await readFileAsString(join(getCurrentDirName(import.meta.url), '../../.prettierrc'), {
      encoding: 'utf8'
    })
  )
  const res = await axios.get('xxxx')
  const app = create(res.data)
  app.usePlugin(createPrefixRemovePlugin('/api'))
  app.usePlugin(ApiTypeInDescription)
  app.usePlugin(CompatibleApiFnNameOnOldversionHandle)
  app.usePlugin(FileHeaderAppendWarning)
  app.usePlugin(createCodeFormatterPlugin(prettierConfig))
  app.usePlugin(createCompileTS2JSPlugin({}, prettierConfig))
  app.cutstomRender(createApiFileModularRender('modules'))
  app.usePlugin(DeleteTsFilePlugin)
  // åªæœ‰è°ƒç”¨startï¼Œé½¿è½®æ‰ä¼šå¼€å§‹çœŸæ­£çš„è½¬åŠ¨
  app.start()
})()
```
ç„¶åä½¿ç”¨nodeç¯å¢ƒæ¥æ‰§è¡Œå®ƒ,æœ€ç»ˆä»–ä¼šåœ¨ä½ é¡¹ç›®ä¸­ç”Ÿæˆä¸€äº›æ–‡ä»¶.

ç›®å‰ç”Ÿæˆçš„apiå®šä¹‰æ–‡ä»¶ä¼šå®šä½åˆ°ä½ æ‰§è¡Œè„šæœ¬çš„ç›¸å¯¹ä½ç½®ä¸‹(å»ºè®®åœ¨æ‰§è¡Œè„šæœ¬å‰ï¼Œä¿æŒä½ çš„gitå·¥ä½œç©ºé—´æ˜¯å¹²å‡€çš„ï¼Œè¿™æ ·ä½ èƒ½æ¸…æ¥šçš„çœ‹åˆ°ç”Ÿæˆäº†å“ªäº›æ–‡ä»¶ï¼Œä¹Ÿæ›´æ˜“å®¹å¤„ç†ä¸€äº›ç‰¹æ®Šæƒ…å†µã€æŒ‡ä¸‡ä¸€ä¸‡ä¸€ä¸‡ä¸€æ’ä»¶ç”Ÿæˆäº†é”™è¯¯çš„å†…å®¹ =ã€‚=ã€‘)ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ª`ApisCreator`æ–‡ä»¶,å®ƒçš„å†…å®¹åº”è¯¥æ˜¯ä¸‹è¾¹è¿™æ ·çš„(å¦‚æœä½ æ²¡æœ‰è®¾ç½®æ¨¡å—æ¸²æŸ“å™¨)ï¼š

```js
export default (request) => {
  return {
    apiFn1(xxx){xxx},
    apiFn1(xxx){xxx},
    ...
  }
}
```
è¿™ä¸ªé»˜è®¤åˆ°å¤„å‡½æ•°éœ€è¦ä½ ä¼ é€’ä¸€ä¸ªè¯·æ±‚å‡½æ•°è¿›å»(ç›®å‰æ¨¡æ¿ä½¿ç”¨çš„axiosé£æ ¼çš„è¯·æ±‚å‡½æ•°,ä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨è‡ªå·±çš„æ¨¡æ¿,ç›¸ä¿¡è¿™äº›å¯¹äºä½ æ¥è¯´,çœŸçš„æ˜¯å°case)ï¼Œä¼šè¿”å›ä¸€ä¸ªåŒ…å«äº†swaggeræ–‡æ¡£ä¸­æ‰€æœ‰è¯·æ±‚è·¯å¾„çš„å¯¹è±¡.æ‰€ä»¥ä½ è¿˜éœ€è¦å®šä¹‰ä¸€ä¸ªè£…é¥°`ApisCreator`çš„æ–‡ä»¶(å¦‚æœå¯ä»¥ï¼Œä½ åç»­åº”è¯¥è€ƒè™‘ä½¿ç”¨æ’ä»¶æ¥è‡ªåŠ¨ç”Ÿæˆå®ƒï¼Œæ‰€ä»¥åœ¨æ–‡æ¡£ååŠéƒ¨åˆ†çœ‹å®Œæ’ä»¶çš„å¼€å‘æè¿°åï¼Œä½ å¯ä»¥å›è¿‡å¤´æ¥å®ç°ä¸€ä¸‹è¿™ä¸ªæ’ä»¶ï¼ŒçœŸçš„ï¼Œç›¸ä¿¡æˆ‘ï¼Œå®ƒå¾ˆeasy)ï¼Œç”¨å®ƒæ¥ä¼ å…¥è¯·æ±‚å‡½æ•°ï¼Œä»¥åŠå¯¼å‡ºè¯¥å¯¹è±¡åˆ°å¤–éƒ¨ä»¥ä¾›ä½¿ç”¨ï¼Œä¸‹è¾¹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼ˆä»…ä¾›å‚è€ƒï¼Œæ‚¨å¯ä»¥è‡ªç”±å‘æŒ¥æƒ³è±¡ï¼‰ï¼š
```js
import requestFn from './xxx'
import getApis from './ApisCreator'
export default getApis(requestFn)
```
è¿™æ ·ä½ åœ¨é¡¹ç›®ä¸­å…¶ä»–åœ°æ–¹è‡ªç”±ä½¿ç”¨è¯¥å¯¹è±¡äº†ï¼Œä»–èº«ä¸ŠåŒ…å«äº†æ–‡æ¡£ä¸­æ‰€æœ‰çš„è¯·æ±‚æ–¹æ³•,å¦‚æœåˆ°è¿™ä¸€æ­¥,ä½ å‘ç°å·²ç»æ»¡è¶³äº†ä½ çš„éœ€æ±‚,é‚£ä¹ˆä½ ç°åœ¨å°±å¯ä»¥ç«‹å³å…³é—­è¿™ä¸ªç½‘é¡µ,ä¸ç”¨å¾€ä¸‹çœ‹äº†ã€‚ä½†æ˜¯å¦‚æœå‘ç°ç”Ÿæˆçš„å†…å®¹å’Œä½ é¢„æœŸæœ‰ä¸€äº›å‡ºå…¥,é‚£ä¹ˆä½ åº”è¯¥èŠ±å‡ åˆ†é’Ÿæ¥é˜…è¯»è¿›ä¸€æ­¥å±•å¼€çš„å†…å®¹ã€‚

## å¦‚ä½•å¼€å‘å±äºè‡ªå·±çš„æ’ä»¶ï¼Ÿæ’ä»¶ç³»ç»Ÿç®€è¿°
æ²¡æœ‰å®ç°ä½ çš„æœ€ç»ˆéœ€æ±‚?æˆ–è®¸ä½ éœ€è¦ä½¿ç”¨æ’ä»¶æ¥å®Œæˆè¿™äº›å·¥ä½œã€‚è¯¥å·¥å…·å®ç°äº†ä¸€ä¸ªminiçš„æ’ä»¶ç³»ç»Ÿ,ä»¥ä¾¿äºå®ç°ä½ çš„ç‰¹æ®Šéœ€æ±‚ã€‚

è¯·å®¹æˆ‘å…ˆç”¨ä¸€ä¸ªæµç¨‹å›¾æ¥è¯´æ˜è¿™ä¸ªå·¥å…·æ•´ä¸ªè¿ä½œæµç¨‹(ä¸æ¶‰åŠè‡ªå®šä¹‰æ’ä»¶çš„å½±å“ä¸‹)ï¼š
```mermaid
graph LR
    A[è°ƒç”¨æ’ä»¶çš„`create`æ–¹æ³•è·å–å®ä¾‹] --> B[ä½¿ç”¨å®ä¾‹æ¥é¢„å…ˆè®¾ç½®æ’ä»¶ç­‰ä¿¡æ¯]
    B --> C[è°ƒç”¨å®ä¾‹çš„`start`æ–¹æ³•]
    C --> D[è½¬æ¢å±‚å¼€å§‹å·¥ä½œ,å®ƒè´Ÿè´£å°†ä¼ é€’è¿›æ¥çš„æ•°æ®è¿›è¡Œç²—åŠ å·¥]
    D --> E[æ¸²æŸ“å±‚å¼€å§‹å·¥ä½œ,å®ƒåœ¨æ¥åˆ°æ•°æ®åå°†å…¶æ•´ç†æˆæ¨¡æ¿æ–‡ä»¶éœ€è¦çš„å½¢çŠ¶,ä»¥é¿å…åœ¨æ¨¡æ¿é‡Œå†™è¿‡å¤šçš„é€»è¾‘;æ¸²æŸ“å±‚ä¼šå°†æ‰€æœ‰éœ€è¦ç”Ÿæˆçš„å†…å®¹ç»„ç»‡æˆä¸€ä¸ªæ–‡ä»¶åˆ—è¡¨]
    E --> F[å†™å…¥å±‚å¼€å§‹å·¥ä½œ,å°†æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨å†™å…¥,å®Œæˆæ•´ä¸ªæµç¨‹]
```
æˆ‘ä»¬æ¸…æ¥šäº†è¿™ä¸ªæµç¨‹æ›´å®¹æ˜“è®©æˆ‘ä¹ˆç†è§£æ’ä»¶çš„è¿è¡Œæœºåˆ¶,æˆ‘ä»¬çš„æ’ä»¶å…¶å®æ— éå°±æ˜¯åœ¨è¿™äº›å£°æ˜å‘¨æœŸä¹‹é—´æ’å…¥æˆ‘ä»¬è‡ªå·±çš„é€»è¾‘,æ‰€ä»¥æˆ‘ä»¬ç†æ‰€å½“ç„¶çš„æƒ³åˆ°,æˆ‘ä»¬çš„æ’ä»¶ä¹Ÿåº”è¯¥ä¼šæœ‰ç”Ÿå‘½å‘¨æœŸçš„å­˜åœ¨,æ˜¯çš„:
```ts
export interface IPlugin {
  // æ•°æ®é›†è¿›è¡Œè½¬æ¢å‰
  beforeTransform?: (context: IContext) => Promise<IContext> | IContext;
  // æ•°æ®é›†è¿›è¡Œè½¬æ¢å
  afterTransform?: (context: IContext) => Promise<IContext> | IContext;
  // æ•°æ®è¿›è¡Œæ¸²æŸ“å‰
  befofeRender?: (context: IContext) => Promise<IContext> | IContext;
  // æ•°æ®è¿›è¡Œæ¸²æŸ“å
  afterRender?: (context: IContext) => Promise<IContext> | IContext;
  // æ–‡ä»¶å†™å…¥å‰
  beforeWriteFile?: (context: IContext) => Promise<IContext> | IContext;
  // æ–‡ä»¶å†™å…¥å
  afterWriteFile?: (context: IContext) => Promise<IContext> | IContext;
}
```
ä¸€ä¸ªæ’ä»¶è‡³å°‘æœ‰ä¸€ä¸ªæˆ–è€…æ›´å¤šçš„ç”Ÿå‘½å‘¨æœŸé’©å­æ‰èƒ½ç§°å¾—ä¸Šæ˜¯ä¸€ä¸ªæ’ä»¶.æˆ‘ä»¬å¯ä»¥åˆ†åˆ«åœ¨å…³é”®èŠ‚ç‚¹ä½¿ç”¨æ’ä»¶çš„é’©å­æ¥æ’å…¥æˆ‘ä»¬è‡ªå·±çš„é€»è¾‘,æ¥å¹²é¢„æœ€ç»ˆçš„è¿è¡Œç»“æœ.ä½ å¯èƒ½ä¼šå¥½å¥‡,ä¸ºä»€ä¹ˆéœ€è¦`xxxafter`å’Œ`xxxbefore`,éš¾é“ä¸å¯ä»¥åœ¨å…³é”®èŠ‚ç‚¹ä¹‹é—´æ”¾ç½®ä¸€ä¸ªé’©å­éš”ç¦»å³å¯å—?è¿™æ ·ç¡®å®å¯ä»¥,ä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯ç»†åˆ†äº†é’©å­,è¿™æ ·æ˜¯ä¸ºäº†åœ¨æœªæ¥æ›´å¥½çš„è®©æˆ‘ä»¬çš„é€»è¾‘æ”¾ç½®åˆ°æ›´æ¸…æ™°çš„å±‚çº§.

åœ¨ä¸Šè¾¹çš„ç¤ºä¾‹ä»£ç ä¸­æˆ‘ä»¬å…¶å®å·²ç»å®ç°äº†ä¸€ä¸ªæ’ä»¶,å®ƒçš„ä½œç”¨æ˜¯åœ¨æˆ‘ä»¬å°†tsç¼–è¯‘ä¸ºjså,åˆ é™¤æ‰åŸå…ˆtsçš„åŠŸèƒ½:
```js
// åˆ é™¤tsæ–‡ä»¶æ’ä»¶
const DeleteTsFilePlugin = {
  afterWriteFile: async (ctx) => {
    const { writedFileList } = ctx
    // è¿‡æ»¤å‡ºtsæ–‡ä»¶
    const tsFileList = writedFileList.filter((item) => item.endsWith('.ts') && !item.endsWith('.d.ts'))
    // ç„¶ååˆ é™¤æ‰
    tsFileList.forEach((file) => {
      fs.unlinkSync(file)
    })
    return ctx
  }
}
```
å®ƒä½¿ç”¨äº†`afterWriteFile`é’©å­æ¥å®Œæˆäº†å·¥ä½œ,å¹¶ä»`ctx`å‚æ•°æ‹¿åˆ°å…³é”®æ•°æ®å®Œæˆäº†åç»­çš„å·¥ä½œ.è¿™ä¸ªctxä½ å¯ä»¥ç†è§£ä¸ºå…¨å±€ä¸Šä¸‹æ–‡,æ’ä»¶æ¯ä¸€ä¸ªæ’ä»¶çš„ç”Ÿå‘½å‘¨æœŸéƒ½ä¼šæ¥æ”¶åˆ°å®ƒ,å®ƒæ˜¯è¿™æ ·ä¸€ä¸ªæ¥å£å½¢çŠ¶:
``` ts
export interface IContext {
  // ä¼ é€’è¿›æ¥çš„åŸå§‹æ•°æ®
  rawJSON: any;
  // ç›®å‰åŠ è½½çš„æ’ä»¶é›†,æ‰€ä»¥ä½ ç”šè‡³å¯ä»¥ä½¿ç”¨æ’ä»¶æ¥æ“ä½œæ’ä»¶
  plugins: IPlugins;
  // é…ç½®,ç›®å‰åªæœ‰ä¸€ä¸ª`outDir`å±æ€§å¯ä¾›ç”¨æˆ·é…ç½®,åæœŸå¯èƒ½ä¼šè€ƒè™‘åˆ é™¤è¯¥å±æ€§,å®Œå…¨ä½¿ç”¨æ’ä»¶æ¥å·¥ä½œ
  config: Config;
  // è®¾ç½®æ¸²æŸ“å±‚å‡½æ•°.æ˜¯çš„,ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨è‡ªå·±çš„æ¸²æŸ“å™¨æ¥æ¥ç®¡æ•´ä¸ªæ¸²æŸ“å·¥ä½œ,å½“ä½ ä½¿ç”¨å’Œæœ¬é¡¹ç›®é»˜è®¤æ¨¡æ¿å·®å¼‚å·¨å¤§çš„æ—¶å€™ä¼šå¾ˆæœ‰ç”¨;å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥å®Œæˆä¸€äº›å…¶å®ƒéœ€æ±‚,æœ¬é¡¹ç›®ä½¿ç”¨å®ƒæ¥å®Œæˆäº†æ–‡ä»¶çš„æ¨¡å—åŒ–åŠŸèƒ½
  setRender: (renderFn: RednerFn) => void;
  // è½¬æ¢å±‚å¤„ç†åçš„æ•°æ®
  transformEdJson: any;
  // æ¸²æŸ“å±‚å¤„ç†å,å¾…æ¸²æŸ“æ•°æ®
  renderData: any;
  // ç»“åˆæ¨¡æ¿å½¢æˆæœ€ç»ˆæ¸²æŸ“ç»“æœ,å…¶å®æè¿°ä¸ºå¾…å†™å…¥é¡¹æ•°æ®æ›´è´´åˆ‡
  renderRes: any[];
  // å†™å…¥çš„æ–‡ä»¶pathåˆ—è¡¨
  writedFileList: string[];
}
```
è¿™æ ·æˆ‘ä»¬å°±å¾ˆæ¸…æ¥šçš„äº†è§£äº†æ’ä»¶çš„è¿è¡Œæµç¨‹äº†,æ€»ç»“å°±æ˜¯ä¸€ä¸ªæ’ä»¶å¯ä»¥æœ‰å¤šä¸ªç”Ÿå‘½å‘¨æœŸé’©å­,ä»–ä»¬ä¼šåœ¨å…³é”®èŠ‚ç‚¹æ’å…¥æˆ‘ä»¬è‡ªå·±çš„é€»è¾‘æ¥å®Œæˆéœ€æ±‚.

### å€¼å¾—ä¸€æçš„ç»†èŠ‚
æ’ä»¶çš„è£…è½½å’Œé€»è¾‘æ‰§è¡Œæ˜¯åˆ†å¼€è¿›è¡Œçš„,å¯ä»¥ç†è§£ä¸ºåœ¨æˆ‘ä»¬çœŸæ­£è°ƒç”¨`start`ä¹‹å‰,æ’ä»¶éƒ½åªå­˜åœ¨è£…è½½è¡Œä¸º,è£…è½½è¿‡ç¨‹ä¼šå°†æ‰€æœ‰æ’ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°èšåˆ,æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ’ä»¶éƒ½å®šä¹‰äº†`befofeRender`é’©å­,é‚£ä¹ˆåœ¨è¿™ä¸ªå£°æ˜å‘¨æœŸèŠ‚ç‚¹,ä¼šä»¥å¼‚æ­¥ç®¡é“å‡½æ•°æ¥æ‰§è¡Œè¿™ä¸¤ä¸ªé’©å­å½¢æˆçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„æ•°ç»„,æ‰€ä»¥è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ’ä»¶å…¥å‚å’Œå‡ºå‚éƒ½æ˜¯`ctx`çš„åŸå› ,å¦å¤–ä¸éœ€è¦ä½ çš„æ’ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­éƒ½æ˜¯å¼‚æ­¥é’©å­,å³ä½¿æ˜¯åŒæ­¥é’©å­ä¹Ÿæ²¡å…³ç³»,å¹¶æ²¡æœ‰å¼ºåˆ¶ä½ å¿…é¡»æ˜¯å¼‚æ­¥é’©å­.

### å›å¤´
åˆ°è¿™é‡Œä½ å·²ç»å¯ä»¥è‡ªå·±æ¥å®ç°ä¸€ä¸ªæ’ä»¶äº†,æ‰€ä»¥,ç°åœ¨ä½ å¯ä»¥å›å¤´å®ç°ä¸€å¼€å§‹æˆ‘ä»¬è®¨è®ºåˆ°çš„è£…é¥°`ApisCreator`æ–‡ä»¶çš„æ’ä»¶å—?å®ƒåº”è¯¥ä½¿ç”¨å“ªä¸ªé’©å­æ¥å®Œæˆå·¥ä½œå‘¢?

å¥½çš„,è¿™ä¸ªæ’ä»¶çš„ä¼ªä»£ç æˆ–è®¸åº”è¯¥æ˜¯ä¸‹è¾¹è¿™ä¸ªæ ·å­:
```js
const CreateApiEntry = {
  xxx: (ctx) => {
    const content = ``
    fs.write(...)
    return ctx
  }
}
```
æ‰€ä»¥å…¶å®å°±è¿™ä¸ªéœ€æ±‚æ¥è®²,æˆ‘ä»¬ä½¿ç”¨ä»»ä½•ä¸€ä¸ªé’©å­éƒ½ä¸ä¼šå½±å“æœ€åçš„ç»“æœ,å› ä¸ºä»–ä¸å’Œæˆ‘ä»¬çš„å…¨å±€ä¸Šä¸‹æ–‡`ctx`äº§ç”Ÿè”ç³»,ä»–ä»…ä»…æ˜¯éœ€è¦ä¸€ä¸ªå†™å…¥ç‰¹å®šå†…å®¹çš„è¿‡ç¨‹,æ¢å¥è¯è¯´,å®ƒéœ€è¦çš„ä»…ä»…æ˜¯ä¸€æ¬¡æ‰§è¡Œæœºä¼š,å“ˆå“ˆ.

### æ›´åŠ ç–¯ç‹‚çš„æƒ³æ³•,ğŸ˜¡æ’ä»¶æ˜¯æ²¡æœ‰ä¸Šé™çš„ğŸ˜¡

ä½ å…¶å®å®Œå…¨æ²¡å¿…è¦è¢«æˆ‘çš„è®¾è®¡æ‰€çº¦æŸ,æ—¢ç„¶ä½ èƒ½å‚ä¸åˆ°å…¨å±€ä¸Šä¸‹æ–‡çš„`get`ä¸`set`æ“ä½œ,é‚£ä¹ˆç­‰åŒäºä½ å’Œæœ¬å·¥å…·æ˜¯ç«™åœ¨åŒä¸€æ‰§è¡Œæƒçš„çš„ç­‰çº§çš„,æ‰€ä»¥ä½ ç”šè‡³å¯ä»¥åˆ›é€ å‡ºå®Œå…¨å¹³è¡Œäºæœ¬å·¥å…·çš„æ‰§è¡Œæµç¨‹,åˆ›é€ å‡ºä¸¤æ¡ç”šè‡³å¤šæ¡äº’ä¸å¹²æ‰°çš„é€»è¾‘.é‚£ä½ è¯´è¿™æ ·è¿˜ä¸ºå•¥è¿˜è¦ä½¿ç”¨è¿™ç©æ„,å²‚ä¸æ˜¯ç­‰åŒä¸æ‰€æœ‰å·¥ä½œéƒ½è¿˜æ˜¯è‡ªå·±æ¥?å…¶å®ä¸æ˜¯,ä½ å¯ä»¥æ›´æ–¹ä¾¿çš„åŸºäºè¿™ä¸ªå·¥å…·ç”Ÿæˆçš„æ•°æ®äº§ç”Ÿæ–°çš„æ•°æ®,æˆ‘çš„æ„æ€æ˜¯ä½ å¯ä»¥åœ¨ä»»æ„é˜¶æ®µåˆ©ç”¨æ’ä»¶æ’å…¥é€»è¾‘æ¥åŸºäºå½“å‰çš„å…¨å±€ä¸Šä¸‹æ–‡ç”Ÿäº§å‡ºå±äºè‡ªå·±çš„æ•°æ®å¹¶æŒ‚è½½åˆ°å…¨å±€ä¸Šä¸‹æ–‡,ç„¶ååœ¨åç»­é˜¶æ®µç»§ç»­ä½¿ç”¨æ’ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­æ¥æ¶ˆè´¹ä½ äº§ç”Ÿçš„è¿™éƒ¨åˆ†è‡ªå®šä¹‰æ•°æ®,è¿™æ ·å°±ä½¿ç”¨æ’ä»¶å®ç°äº†å®Œå…¨å¹³è¡Œçš„æ‰§è¡Œæµç¨‹,æ’ä»¶é€»è¾‘æ˜¯æ²¡æœ‰é™åˆ¶ä¸ä¸Šé™çš„,æ‰€ä»¥ä½ å¯ä»¥çœŸæ­£æ”¾é£è‡ªæˆ‘çš„å‘æŒ¥ğŸ˜€.crazy~

æˆ‘çš„è¯„ä»·æ˜¯,å¦‚æœæ²¡æœ‰é€†å¤©çš„éœ€æ±‚,åŸºæœ¬æ²¡å•¥æ¯›ç”¨,ä½†æ˜¯è¿™è‡³å°‘è®©ä½ æ˜ç™½äº†æ’ä»¶çœŸçš„æ²¡æœ‰ä¸Šé™,ä½ ç”šè‡³ä¹Ÿå¯ä»¥ç”¨æ’ä»¶æ¥å®Œå…¨ç ´åæ•´ä¸ªæµç¨‹.ğŸ˜ˆğŸ˜ˆğŸ˜ˆ

## å…³äºå¦‚ä½•ä½¿ç”¨è‡ªå·±çš„æ¨¡æ¿
å…³äºæœ¬é¡¹ç›®ä½¿ç”¨çš„æ¨¡æ¿å¼•æ“,ç›®å‰ä½¿ç”¨ç‰ˆæœ¬:3.1.1(å‡ ä¹æ²¡æœ‰å­¦ä¹ æˆæœ¬,æ¨¡æ¿å¼•æ“éƒ½å¤§åŒå°å¼‚):
https://www.npmjs.com/package/eta

é»˜è®¤é¡¹ç›®æ¨¡æ¿ä½ç½®(å®‰è£…è¯¥åŒ…å,ä½ å¯ä»¥å°†å…¶å¤åˆ¶å‡ºæ¥ç»§ç»­è‡ªå·±çš„åŠ å·¥):`\node_modules\swagger2apis\dist\template`,
ç„¶åå°±æ˜¯å®ç°å¹¶è®¾ç½®è‡ªå·±çš„æ¸²æŸ“å™¨
```js
import { Eta } from "eta";
const MyRender = async (ctx) => {
  const { renderData } = ctx;
  const eta = new Eta({
    views: 'ä½ çš„æ¨¡æ¿æ–‡ä»¶å¤¹è·¯å¾„'
  });
  return [
    {
      content: eta.render("./apis", renderData),
      extName: "ts",
      fileName: ENTRY_FILE_NAME
    },
    {
      content: eta.render("./interfaces", renderData),
      extName: "d.ts",
      fileName: "interfaces"
    }
  ];
};
app.cutstomRender(MyRender)
```
è¿™æ ·ä½ å°±å¯ä»¥ä¸ºæ‰€æ¬²ä¸ºçš„ç”Ÿæˆä»»æ„å†…å®¹äº†~

## æœ€å

è¿™å‡ ä¹å°±æ˜¯è¿™ä¸ªå°å·¥å…·çš„å…¨éƒ¨å†…å®¹äº†,ç¥ ç©çš„å¼€å¿ƒ~
